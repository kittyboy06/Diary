import{c as G,u as H,a as J,r as l,t as i,j as e,X as K,i as N,M as Q}from"./index-CC0qksji.js";import{b as V,c as W,a as Y,i as Z,C as ee,d as te,e as ae,f as se,u as re,h as le}from"./todoService-qaMnyPq1.js";import{S as w}from"./Skeleton-D_Xesvck.js";import{F as f,A as ie}from"./index-CjgGk_eb.js";import{T as y,P as I}from"./trash-2-BDjx4oTP.js";import{F as ne}from"./folder-plus-B7snLzr1.js";import{m as F}from"./proxy-DlMVTydf.js";import{C as oe}from"./calendar-DraWzcCT.js";import{f as de}from"./format-mVbgGZla.js";import{i as L}from"./isToday-W0RLf5oP.js";import"./addDays-BxqyZ8Wb.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=G("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function we(){var M;const{currentUser:n}=H(),{t:xe}=J(),[h,c]=l.useState([]),[o,b]=l.useState([]),[s,g]=l.useState("all"),[U,C]=l.useState(!0),[x,T]=l.useState(""),[p,S]=l.useState(""),[m,z]=l.useState(""),[B,j]=l.useState(!1),[D,d]=l.useState(!1);l.useEffect(()=>{n&&E()},[n,s]);const E=async()=>{try{C(!0);const[t,a]=await Promise.all([V(n.id,s),W(n.id)]);c(t||[]),(o.length===0||a.length!==o.length)&&b(a||[])}catch(t){console.error(t),i.error("Failed to load data")}finally{C(!1)}},O=async t=>{if(t.preventDefault(),!!m.trim())try{const a=await te(n.id,m);b([...o,a]),z(""),j(!1),i.success("Folder created")}catch(a){console.error(a),i.error("Failed to create folder")}},q=async(t,a)=>{if(a.stopPropagation(),!!window.confirm("Delete folder and all its tasks?"))try{await ae(t),b(o.filter(r=>r.id!==t)),s===t&&g("all"),i.success("Folder deleted")}catch(r){console.error(r),i.error("Failed to delete folder")}},R=async t=>{if(t.preventDefault(),!!x.trim())try{const a=Date.now(),r={id:a,text:x,completed:!1,created_at:new Date().toISOString(),deadline:p?new Date(p).toISOString():null};c([r,...h]),T(""),S("");const u=s!=="all"&&s!=="unassigned"?s:null,X=await se(n.id,x,p||null,u);c(_=>_.map($=>$.id===a?X:$))}catch(a){console.error(a),i.error("Failed to add task"),loadTodos()}},A=async(t,a)=>{try{c(r=>r.map(u=>u.id===t?{...u,completed:!a}:u)),await re(t,{completed:!a})}catch(r){console.error(r),i.error("Failed to update task"),loadTodos()}},P=async t=>{try{c(a=>a.filter(r=>r.id!==t)),await le(t),i.success("Task deleted")}catch(a){console.error(a),i.error("Failed to delete task"),loadTodos()}},k=h.filter(t=>!t.completed),v=h.filter(t=>t.completed);return U&&h.length===0?e.jsxs("div",{className:"max-w-2xl mx-auto p-4 space-y-4",children:[e.jsx(w,{className:"h-12 w-full rounded-xl"}),e.jsx(w,{className:"h-16 w-full rounded-xl"}),e.jsx(w,{className:"h-16 w-full rounded-xl"})]}):e.jsxs("div",{className:"relative flex h-[calc(100dvh-theme(spacing.20))] md:h-[calc(100vh-theme(spacing.20))] overflow-hidden",children:[D&&e.jsx("div",{className:"absolute inset-0 bg-black/50 z-20 md:hidden",onClick:()=>d(!1)}),e.jsxs("aside",{className:`
                absolute md:relative z-30 w-64 h-full bg-white dark:bg-slate-900 border-r border-neutral-200 dark:border-slate-800
                transition-transform duration-300 md:translate-x-0
                ${D?"translate-x-0":"-translate-x-full"}
                flex flex-col
            `,children:[e.jsxs("div",{className:"p-4 border-b border-neutral-100 dark:border-slate-800 flex justify-between items-center",children:[e.jsx("h2",{className:"font-semibold text-neutral-800 dark:text-white",children:"Folders"}),e.jsx("button",{onClick:()=>d(!1),className:"md:hidden text-neutral-500",children:e.jsx(K,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[e.jsxs("button",{onClick:()=>{g("all"),d(!1)},className:`w-full flex items-center gap-2 p-2 rounded-lg text-sm font-medium transition-colors ${s==="all"?"bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400":"text-neutral-600 dark:text-slate-400 hover:bg-neutral-50 dark:hover:bg-slate-800"}`,children:[e.jsx(N,{size:18}),"All Tasks"]}),e.jsxs("button",{onClick:()=>{g("unassigned"),d(!1)},className:`w-full flex items-center gap-2 p-2 rounded-lg text-sm font-medium transition-colors ${s==="unassigned"?"bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400":"text-neutral-600 dark:text-slate-400 hover:bg-neutral-50 dark:hover:bg-slate-800"}`,children:[e.jsx(f,{size:18}),"Unassigned"]}),e.jsx("div",{className:"pt-4 pb-2 px-2 text-xs font-semibold text-neutral-400 uppercase tracking-wider",children:"My Folders"}),o.map(t=>e.jsxs("div",{onClick:()=>{g(t.id),d(!1)},className:`group w-full flex items-center justify-between p-2 rounded-lg text-sm font-medium transition-colors cursor-pointer ${s===t.id?"bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400":"text-neutral-600 dark:text-slate-400 hover:bg-neutral-50 dark:hover:bg-slate-800"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 truncate",children:[e.jsx(f,{size:18}),e.jsx("span",{className:"truncate",children:t.name})]}),e.jsx("button",{onClick:a=>q(t.id,a),className:"opacity-0 group-hover:opacity-100 p-1 hover:text-red-500 text-neutral-400",children:e.jsx(y,{size:14})})]},t.id))]}),e.jsx("div",{className:"p-4 border-t border-neutral-100 dark:border-slate-800",children:B?e.jsxs("form",{onSubmit:O,className:"flex gap-2",children:[e.jsx("input",{autoFocus:!0,type:"text",value:m,onChange:t=>z(t.target.value),placeholder:"Name...",className:"flex-1 bg-neutral-100 dark:bg-slate-800 rounded px-2 py-1 text-sm outline-none ring-1 ring-transparent focus:ring-indigo-500 dark:text-white",onBlur:()=>!m&&j(!1)}),e.jsx("button",{type:"submit",disabled:!m,className:"text-indigo-600",children:e.jsx(I,{size:18})})]}):e.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-2 text-sm font-medium text-neutral-500 hover:text-indigo-600 transition-colors",children:[e.jsx(ne,{size:18}),"New Folder"]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-8 w-full",children:e.jsxs("div",{className:"max-w-3xl mx-auto pb-20",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("button",{onClick:()=>d(!0),className:"md:hidden p-2 -ml-2 text-neutral-500",children:e.jsx(Q,{size:24})}),e.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/30 rounded-2xl text-indigo-600 dark:text-indigo-400",children:s==="all"?e.jsx(N,{size:28}):s==="unassigned"?e.jsx(f,{size:28}):e.jsx(f,{size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900 dark:text-white",children:s==="all"?"All Tasks":s==="unassigned"?"Unassigned":((M=o.find(t=>t.id===s))==null?void 0:M.name)||"Folder"}),e.jsxs("p",{className:"text-neutral-500 dark:text-slate-400 font-medium",children:[k.length," pending tasks"]})]})]}),e.jsx("form",{onSubmit:R,className:"relative mb-8 group",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:x,onChange:t=>T(t.target.value),placeholder:"Add a new task...",className:"w-full pl-6 pr-32 py-4 bg-white dark:bg-slate-800 border-none shadow-sm rounded-2xl text-lg outline-none ring-1 ring-neutral-200 dark:ring-slate-700 focus:ring-2 focus:ring-indigo-500 transition-shadow dark:text-white placeholder:text-neutral-400"}),e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2",children:[e.jsx("input",{type:"date",value:p,onChange:t=>S(t.target.value),className:"bg-transparent text-xs text-neutral-500 dark:text-slate-400 border border-neutral-200 dark:border-slate-600 rounded-lg px-2 py-1 outline-none focus:border-indigo-500"}),e.jsx("button",{type:"submit",disabled:!x.trim(),className:"p-2 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 disabled:opacity-50 disabled:hover:bg-indigo-600 transition-colors",children:e.jsx(I,{size:24})})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-3",children:e.jsxs(ie,{mode:"popLayout",children:[k.length===0&&v.length===0&&e.jsxs(F.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12 text-neutral-400",children:[e.jsx(N,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{children:"No tasks yet. Add one above!"})]}),k.map(t=>e.jsxs(F.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},className:"group flex items-center gap-4 bg-white dark:bg-slate-800 p-4 rounded-xl border border-neutral-100 dark:border-slate-700 shadow-sm hover:border-indigo-200 dark:hover:border-indigo-900 transition-colors",children:[e.jsx("button",{onClick:()=>A(t.id,t.completed),className:"flex-shrink-0 text-neutral-300 hover:text-indigo-500 transition-colors",children:e.jsx(ce,{size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`font-medium break-all text-neutral-800 dark:text-slate-200 ${t.completed?"line-through text-neutral-400":""}`,children:t.text}),t.deadline&&e.jsxs("div",{className:`flex items-center gap-1 text-xs mt-1 ${!t.completed&&Z(new Date(t.deadline))&&!L(new Date(t.deadline))?"text-red-500 font-medium":"text-neutral-400"}`,children:[e.jsx(oe,{size:12}),e.jsx("span",{children:L(new Date(t.deadline))?"Today":Y(new Date(t.deadline))?"Tomorrow":de(new Date(t.deadline),"MMM d")})]})]}),e.jsx("button",{onClick:()=>P(t.id),className:"opacity-0 group-hover:opacity-100 p-2 text-neutral-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-all",children:e.jsx(y,{size:18})})]},t.id))]})}),v.length>0&&e.jsxs("div",{className:"pt-4 border-t border-neutral-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-sm font-semibold text-neutral-400 mb-4 uppercase tracking-wider",children:"Completed"}),e.jsx("div",{className:"space-y-2 opacity-60",children:v.map(t=>e.jsxs(F.div,{layout:!0,className:"flex items-center gap-4 p-3 rounded-lg bg-neutral-50 dark:bg-slate-800/50",children:[e.jsx("button",{onClick:()=>A(t.id,t.completed),className:"flex-shrink-0 text-emerald-500",children:e.jsx(ee,{size:24})}),e.jsx("span",{className:"flex-1 text-neutral-500 dark:text-slate-500 line-through decoration-2 decoration-neutral-300 dark:decoration-slate-600 break-all",children:t.text}),e.jsx("button",{onClick:()=>P(t.id),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg transition-colors",children:e.jsx(y,{size:16})})]},t.id))})]})]})]})})]})}export{we as default};
