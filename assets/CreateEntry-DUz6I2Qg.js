import{c as H,u as X,a as Y,b as q,r as a,j as e,d as P,X as J,e as K,t as d}from"./index-DQ_HIcJs.js";import{b as Q,c as V,u as W,d as Z}from"./entryService-CdlEl31N.js";import{m as F}from"./proxy-_O7j-Vtr.js";import{A as ee}from"./index--W1AxoUr.js";import{C as te}from"./calendar-CK67t8Mz.js";import{F as ae}from"./folder-DF_W8vsx.js";import{S as se}from"./save-D-ODLWQw.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=H("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),me=()=>{const{currentUser:r}=X(),{t:s}=Y();q();const[x,g]=a.useState(""),[m,f]=a.useState(""),[i,D]=a.useState(new Date().toISOString().split("T")[0]),[l,v]=a.useState(!1),[y,h]=a.useState(null),[j,p]=a.useState(null),[k,E]=a.useState("happy"),[w,le]=a.useState(!1),[N,L]=a.useState([]),[S,C]=a.useState(""),[z,b]=a.useState(!1),[I,c]=a.useState(""),[_,M]=a.useState(null);a.useEffect(()=>{(async()=>{if(r!=null&&r.id){const n=await Q(r.id,l);L(n||[]),C("")}})()},[r,l]);const O=async t=>{if(t.preventDefault(),!l)try{const o=await V(r.id);if(!o){d.error("Please set a PIN in Secret Log first.");return}M(o),b(!0)}catch(o){console.error(o),d.error("Failed to verify security.")}else v(!1)},T=t=>{t.preventDefault(),I===_?(v(!0),b(!1),c(""),d.success("Secret Mode Enabled")):(d.error("Incorrect PIN"),c(""))},U=t=>{const n=t.target.files[0];n&&(h(n),p(URL.createObjectURL(n)))},A=[{id:"happy",label:"Happy",emoji:"ðŸ˜ƒ"},{id:"neutral",label:"Neutral",emoji:"ðŸ˜"},{id:"sad",label:"Sad",emoji:"ðŸ˜”"},{id:"angry",label:"Angry",emoji:"ðŸ˜¡"},{id:"excited",label:"Excited",emoji:"ðŸ¤©"}],R=async t=>{if(t.preventDefault(),!x&&!m)return;const n=async()=>{let o=null;y&&(o=await W(y,r.id));let u=new Date;if(i){const[G,$,B]=i.split("-").map(Number);u.setFullYear(G),u.setMonth($-1),u.setDate(B)}await Z(r.id,{title:x,content:m,imageUrl:o,isSecret:l,mood:k,date:u.toISOString(),folderId:S||null})};d.promise(n(),{loading:"Saving entry...",success:()=>(g(""),f(""),h(null),p(null),"Entry saved! Ready for next one."),error:"Failed to save entry"})};return e.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl mx-auto relative px-4 md:px-8 py-8",children:[e.jsx(ee,{children:z&&e.jsx(F.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 rounded-3xl backdrop-blur-md bg-white/80 dark:bg-slate-900/90 flex flex-col items-center justify-center p-6 border border-rose-100 dark:border-rose-900/30",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-xl border border-rose-100 dark:border-rose-900/50 w-full max-w-sm text-center",children:[e.jsx("div",{className:"bg-rose-100 dark:bg-rose-900/30 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 text-rose-600 dark:text-rose-400",children:e.jsx(P,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-neutral-800 dark:text-white mb-2",children:s("enter_pin")}),e.jsx("p",{className:"text-sm text-neutral-500 dark:text-slate-400 mb-6",children:s("locked_msg_short")||"Enter PIN to access Secret Folders"}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsx("input",{type:"password",autoFocus:!0,maxLength:6,value:I,onChange:t=>c(t.target.value),className:"w-full text-center text-2xl tracking-widest p-3 rounded-xl border border-neutral-200 dark:border-slate-700 bg-neutral-50 dark:bg-slate-900 text-neutral-900 dark:text-white focus:ring-2 focus:ring-rose-500 focus:border-rose-500 outline-none"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{b(!1),c("")},className:"flex-1 px-4 py-2 rounded-xl text-neutral-600 dark:text-slate-300 hover:bg-neutral-100 dark:hover:bg-slate-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-rose-600 text-white px-4 py-2 rounded-xl font-medium hover:bg-rose-700 transition-colors shadow-lg shadow-rose-200 dark:shadow-rose-900/20",children:"Unlock"})]})]})]})})}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-neutral-100 dark:border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-neutral-100 dark:border-slate-700 bg-neutral-50/50 dark:bg-slate-900/50",children:e.jsx("h1",{className:"text-2xl font-bold text-neutral-800 dark:text-white",children:s("new_entry")})}),e.jsxs("form",{onSubmit:R,className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-center space-x-4 pb-4 border-b border-neutral-100 dark:border-slate-700",children:A.map(t=>e.jsx("button",{type:"button",onClick:()=>E(t.id),className:`text-3xl p-3 rounded-2xl transition-all duration-300 ${k===t.id?"bg-indigo-100 dark:bg-indigo-900/30 scale-110 shadow-sm":"hover:bg-neutral-50 dark:hover:bg-slate-700 grayscale hover:grayscale-0 opacity-70 hover:opacity-100"}`,title:t.label,children:t.emoji},t.id))}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:s("title_placeholder"),className:"w-full text-xl font-semibold placeholder-neutral-400 dark:placeholder-slate-500 border-none focus:ring-0 p-0 text-neutral-800 dark:text-white bg-transparent",value:x,onChange:t=>g(t.target.value)})}),e.jsx("div",{children:e.jsx("textarea",{placeholder:s("content_placeholder"),className:"w-full h-64 resize-none text-lg leading-relaxed placeholder-neutral-400 dark:placeholder-slate-500 border-none focus:ring-0 p-0 text-neutral-600 dark:text-slate-300 bg-transparent",value:m,onChange:t=>f(t.target.value)})}),j&&e.jsxs("div",{className:"relative rounded-xl overflow-hidden shadow-sm",children:[e.jsx("img",{src:j,alt:"Preview",className:"w-full h-auto max-h-96 object-cover"}),e.jsx("button",{type:"button",onClick:()=>{h(null),p(null)},className:"absolute top-2 right-2 bg-black/50 text-white p-1 rounded-full hover:bg-black/70",children:e.jsx(J,{size:16})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 pt-4 border-t border-neutral-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("label",{className:"cursor-pointer flex items-center space-x-2 text-neutral-500 dark:text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",children:[e.jsx(re,{size:20}),e.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:s("add_image")}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:U})]}),e.jsxs("div",{onClick:()=>document.getElementById("date-picker").showPicker(),className:"cursor-pointer flex items-center space-x-2 text-neutral-500 dark:text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors relative",children:[e.jsx(te,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:i===new Date().toISOString().split("T")[0]?"Today":new Date(i).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),e.jsx("input",{id:"date-picker",type:"date",className:"absolute inset-0 opacity-0 w-full h-full pointer-events-none",value:i,onChange:t=>D(t.target.value)})]}),N.length>0&&e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:S,onChange:t=>C(t.target.value),className:"appearance-none pl-8 pr-8 py-1 rounded-full border border-neutral-200 dark:border-slate-700 bg-transparent text-sm text-neutral-600 dark:text-slate-300 focus:ring-0 outline-none cursor-pointer hover:border-indigo-400 transition-all max-w-[150px] truncate",children:[e.jsx("option",{value:"",className:"bg-white dark:bg-slate-800 text-neutral-900 dark:text-white",children:l?"General Secret":"General"}),N.map(t=>e.jsx("option",{value:t.id,className:"bg-white dark:bg-slate-800 text-neutral-900 dark:text-white",children:t.name},t.id))]}),e.jsx(ae,{size:16,className:"absolute left-2.5 top-1.5 text-neutral-400 pointer-events-none"})]}),e.jsxs("label",{className:`cursor-pointer flex items-center space-x-2 transition-colors ${l?"text-rose-500":"text-neutral-500 dark:text-slate-400 hover:text-rose-500 dark:hover:text-rose-400"}`,children:[e.jsx(P,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:s(l?"secret_entry":"make_secret")}),e.jsx("input",{type:"checkbox",className:"hidden",checked:l,onClick:O,onChange:()=>{}})]})]}),e.jsxs("button",{type:"submit",disabled:w,className:"w-full md:w-auto flex items-center justify-center space-x-2 bg-indigo-600 text-white px-6 py-2.5 rounded-full font-medium hover:bg-indigo-700 transition-all shadow-lg hover:shadow-indigo-500/25 disabled:opacity-70 disabled:cursor-not-allowed",children:[w?e.jsx(K,{className:"animate-spin",size:20}):e.jsx(se,{size:20}),e.jsx("span",{children:s("save_entry")})]})]})]})]})]})};export{me as default};
