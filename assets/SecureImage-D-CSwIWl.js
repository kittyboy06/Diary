import{c as k,r,j as e,X as N}from"./index-CHzR-8ww.js";import{A as y}from"./index-vA4RPWVM.js";import{m as D}from"./proxy-itqZaXMe.js";import{C}from"./calendar-C847GZGj.js";import{F as I}from"./folder-CZgyDXM9.js";import{S as E}from"./save-Cx3ikS70.js";import{f as F}from"./format-mVbgGZla.js";import{k as z}from"./entryService-D353WhkT.js";import{S as M}from"./Skeleton-6teEfq3M.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=k("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=k("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Y=({isOpen:l,onClose:o,entry:a,folders:c,onSave:u})=>{const[x,s]=r.useState(""),[i,m]=r.useState(""),[d,g]=r.useState(""),[p,h]=r.useState(""),[b,v]=r.useState(!1);r.useEffect(()=>{if(a){s(a.title||""),s(a.title||""),m(a.content||""),g(a.folderId||"");let t=new Date;a.date&&(typeof a.date.toDate=="function"?t=a.date.toDate():t=new Date(a.date)),h(F(t,"yyyy-MM-dd"))}},[a]);const j=async t=>{t.preventDefault(),v(!0);try{let n=new Date;if(a.date){const f=typeof a.date.toDate=="function"?a.date.toDate():new Date(a.date);isNaN(f.getTime())||(n=new Date(f))}if(p){const[f,S,w]=p.split("-").map(Number);n.setFullYear(f),n.setMonth(S-1),n.setDate(w)}await u(a.id,{title:x,content:i,folderId:d===""?null:d,date:n.toISOString()}),o()}catch(n){console.error("Failed to save",n)}finally{v(!1)}};return l?e.jsx(y,{children:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o,children:e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},onClick:t=>t.stopPropagation(),className:"bg-white dark:bg-slate-800 rounded-3xl w-full max-w-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-neutral-100 dark:border-slate-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-neutral-800 dark:text-white",children:"Edit Entry"}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-neutral-100 dark:hover:bg-slate-700 rounded-full transition-colors text-neutral-500 dark:text-slate-400",children:e.jsx(N,{size:20})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 overflow-y-auto flex-1 space-y-6",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Entry Title",value:x,onChange:t=>s(t.target.value),className:"w-full text-2xl font-bold placeholder-neutral-300 dark:placeholder-slate-600 border-none focus:ring-0 p-0 text-neutral-800 dark:text-white bg-transparent"})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:p,onChange:t=>h(t.target.value),className:"pl-9 pr-4 py-2 rounded-xl border border-neutral-200 dark:border-slate-700 bg-neutral-50 dark:bg-slate-900/50 text-sm font-medium text-neutral-700 dark:text-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none cursor-pointer"}),e.jsx(C,{size:16,className:"absolute left-3 top-2.5 text-neutral-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:d,onChange:t=>g(t.target.value),className:"appearance-none pl-9 pr-8 py-2 rounded-xl border border-neutral-200 dark:border-slate-700 bg-neutral-50 dark:bg-slate-900/50 text-sm font-medium text-neutral-700 dark:text-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none cursor-pointer",children:[e.jsx("option",{value:"",children:"General (No Folder)"}),c.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(I,{size:16,className:"absolute left-3 top-2.5 text-neutral-400 pointer-events-none"})]})]}),e.jsx("div",{className:"flex-1 min-h-[200px]",children:e.jsx("textarea",{placeholder:"Start writing...",value:i,onChange:t=>m(t.target.value),className:"w-full h-full min-h-[300px] resize-none text-lg leading-relaxed placeholder-neutral-300 dark:placeholder-slate-600 border-none focus:ring-0 p-0 text-neutral-600 dark:text-slate-300 bg-transparent"})})]}),e.jsxs("div",{className:"p-6 border-t border-neutral-100 dark:border-slate-700 bg-neutral-50/50 dark:bg-slate-900/50 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:o,className:"px-5 py-2.5 rounded-xl text-neutral-600 dark:text-slate-300 hover:bg-neutral-100 dark:hover:bg-slate-700 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:b,className:"flex items-center gap-2 bg-indigo-600 text-white px-6 py-2.5 rounded-xl font-medium hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-200 dark:shadow-indigo-900/20 disabled:opacity-70 disabled:cursor-not-allowed",children:b?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(E,{size:18}),e.jsx("span",{children:"Save Changes"})]})})]})]})})}):null},$=({path:l,alt:o,className:a})=>{const[c,u]=r.useState(null),[x,s]=r.useState(!0);return r.useEffect(()=>{let i=!0;return(async()=>{if(!l){s(!1);return}if(l.startsWith("http")&&!l.includes("storage/v1/object/public")){u(l),s(!1);return}const d=await z(l);i&&(u(d),s(!1))})(),()=>{i=!1}},[l]),x?e.jsx(M,{className:`rounded-lg ${a}`}):c?e.jsx("img",{src:c,alt:o,className:a,loading:"lazy"}):null};export{Y as E,W as S,X as a,$ as b};
